# PR-011 — API Contract Freeze & Frontend Green Light

## Purpose

Freeze the **public HTTP API contract** exposed by the backend and formally declare it stable for frontend and mobile client development.

This PR marks the transition from **backend foundation** to **product iteration**.

No functional changes are introduced.

---

## References

* `AGENTS.md` — global collaboration rules
* `COMMON.md` — shared API semantics
* `docs/PR-007.md` — HTTP adapter
* `docs/PR-010.md` — Composition root

All API guarantees in this PR must reflect the current backend behavior.

---

## Scope (Hard Lock)

### ✅ Included

* Explicit documentation of the `/api/v1/candles` endpoint
* Request/response contract freeze
* Versioning guarantees

### ❌ Excluded

* Backend code changes
* New endpoints
* Breaking changes
* Frontend implementation

If it changes runtime behavior, it does not belong here.

---

## API Contract (Frozen)

### Endpoint

```
GET /api/v1/candles
```

---

### Query Parameters

| Name        | Type   | Required | Notes                   |
| ----------- | ------ | -------- | ----------------------- |
| `symbol`    | string | yes      | Uppercase, normalized   |
| `timeframe` | string | yes      | Canonical timeframe ID  |
| `from`      | string | yes      | RFC3339, UTC, inclusive |
| `to`        | string | yes      | RFC3339, UTC, exclusive |

---

### Success Response (200)

```json
{
  "symbol": "BTCUSDT",
  "timeframe": "1m",
  "candles": [
    {
      "timestamp": "2024-01-01T00:00:00Z",
      "open": 42000.0,
      "high": 42100.0,
      "low": 41950.0,
      "close": 42050.0,
      "volume": 123.45
    }
  ]
}
```

---

### Error Responses

| Status | Meaning                       |
| -----: | ----------------------------- |
|    400 | Invalid or missing parameters |
|    500 | Internal server error         |

Error body format is **not guaranteed** and must not be relied upon by clients.

---

## Compatibility Guarantees

* Endpoint path will not change within v1
* Query parameter names and meanings are stable
* Response field names and types are stable
* Candle ordering is ascending by timestamp

Any breaking change requires a **new API version**.

---

## Frontend Guidance

Frontend clients may assume:

* Deterministic ordering
* Possible gaps in candle data
* Empty candle arrays are valid

Frontend must not assume:

* Continuous time series
* Fixed candle count
* Presence of indicators

---

## Definition of Done (PR-011)

PR-011 is considered **done** only when **all** conditions below are met:

* [ ] API contract documented explicitly
* [ ] Documentation matches actual backend behavior
* [ ] No backend code changes are introduced
* [ ] Versioning rules are clearly stated
* [ ] Frontend assumptions are documented
* [ ] PR is reviewable in under 10 minutes

---

## Explicit Non-Goals

* No OpenAPI schema generation
* No SDK generation
* No backward compatibility shims

---

## Reviewer Checklist

Reviewer must confirm:

* Contract is precise and unambiguous
* No hidden breaking changes
* Frontend has sufficient information to proceed

---

## Guiding Principle

A frozen contract buys freedom on both sides.
