# PR-006 — Application Use Case: GetCandleSeries

## Purpose

Introduce the first **application-level use case**: **GetCandleSeries**.

This use case coordinates domain objects and application ports to retrieve a CandleSeries for a given Symbol, Timeframe, and time range.

It contains **no infrastructure logic** and acts as the primary entry point for adapters (HTTP, CLI, etc.).

---

## References

* `AGENTS.md` — global collaboration rules
* `BACKEND.md` — backend architecture & PR sequencing
* `COMMON.md` — shared domain semantics
* `docs/PR-002.md` — Timeframe
* `docs/PR-003.md` — Candle
* `docs/PR-004.md` — CandleSeries
* `docs/PR-005.md` — CandleRepositoryPort

All definitions in this PR must be consistent with the above.

---

## Scope (Hard Lock)

### ✅ Included

* GetCandleSeries use case interface
* GetCandleSeries use case implementation
* Use case unit tests

### ❌ Excluded

* HTTP / transport concerns
* Input validation beyond domain rules
* Caching or persistence logic
* Authorization or authentication

If it is not **orchestrating GetSeries**, it does not belong here.

---

## Allowed Files

```
/backend/application/usecases/getcandleseries.go
/backend/tests/application/usecases/getcandleseries_test.go
```

No other files may be modified.

---

## Use Case Definition

### Input

* Symbol
* Timeframe
* From (time.Time, inclusive)
* To (time.Time, exclusive)

### Output

* CandleSeries
* error

---

## Behavior

* Delegates data access to CandleRepositoryPort
* Does not transform CandleSeries
* Does not suppress or wrap errors
* Returns exactly what the repository returns

---

## Interaction Rules

* Use case depends only on:

  * CandleRepositoryPort
  * Domain objects
* Use case must be injectable with any port implementation

---

## Error Handling

* If repository returns an error, it is returned as-is
* Use case must not panic

---

## Behavioral Specification (Tests Must Cover All)

Tests define the **observable behavior** of the use case.

### Required Test Cases (Minimum)

* `TestGetCandleSeries_DelegatesToRepository`
* `TestGetCandleSeries_ReturnsCandleSeries`
* `TestGetCandleSeries_PropagatesRepositoryError`

Tests must use a **fake CandleRepositoryPort** defined in test scope.

---

## Implementation Constraints

* Use case must be a small struct with dependencies injected
* Single public Execute method
* No global state
* No side effects

---

## Definition of Done (PR-006)

PR-006 is considered **done** only when **all** conditions below are met:

* [ ] GetCandleSeries interface exists
* [ ] Use case implementation exists
* [ ] All required tests are implemented
* [ ] Tests fail before implementation
* [ ] Tests pass after implementation
* [ ] Use case depends only on ports and domain
* [ ] No infrastructure code is referenced
* [ ] No files outside allowed list are changed
* [ ] Static analysis passes with no new warnings
* [ ] CI pipeline is green
* [ ] PR is reviewable in under 10 minutes

---

## Explicit Non-Goals

* No batching or pagination
* No caching
* No retries

---

## Reviewer Checklist

Reviewer must confirm:

* Use case is thin and orchestration-only
* No logic leakage into use case
* Dependency direction is correct

---

## Guiding Principle

Use cases coordinate. They do not decide.
