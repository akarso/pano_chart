# PR-001 — Domain: Symbol Value Object

## Purpose

Introduce the **Symbol** value object into the domain layer.

This PR defines **what a Symbol is and is not**, using tests as the primary specification.

No other domain concepts may be introduced in this PR.

---

## References

* `AGENTS.md` — global collaboration rules
* `BACKEND.md` — backend architecture & PR sequencing
* `COMMON.md` — shared Symbol semantics

This PR must comply with all three documents.

---

## Scope (Hard Lock)

### ✅ Included

* Symbol value object (domain)
* Symbol unit tests

### ❌ Excluded

* Any other domain objects
* Any ports or adapters
* Any application logic
* Any infrastructure code

If it is not **Symbol**, it does not belong here.

---

## Allowed Files

```
/backend/domain/symbol.go
/backend/tests/domain/symbol_test.go
```

No other files may be modified.

---

## Behavioral Specification (Tests Must Cover All)

### Creation Rules

* Accepts valid symbol strings
* Rejects empty strings
* Rejects whitespace-only strings
* Rejects symbols containing illegal characters

Allowed characters:

* `A–Z`
* `0–9`
* `-` (dash)
* `_` (underscore)

---

### Normalization Rules

* Symbol is normalized on creation
* Normalized representation is uppercase
* Separators (`-`, `_`) are preserved

Examples:

* `btc_usdt` → `BTC_USDT`
* `eth-usd` → `ETH-USD`

---

### Immutability Rules

* Symbol is immutable after creation
* No setters or mutation methods

---

### Equality Semantics

* Symbols are equal if their normalized values are equal
* Equality is value-based, not reference-based

---

## Test Requirements

* Tests must be written **before** implementation
* Each test covers exactly one behavior
* Table-driven tests are preferred where applicable

### Required Test Cases (Minimum)

* `TestSymbol_AcceptsValidSymbols`
* `TestSymbol_RejectsEmptyString`
* `TestSymbol_RejectsWhitespaceOnly`
* `TestSymbol_RejectsIllegalCharacters`
* `TestSymbol_NormalizesToUppercase`
* `TestSymbol_EqualityByValue`

---

## Implementation Constraints

* Symbol is a value object
* No external dependencies
* Constructor performs all validation
* Errors must be explicit and descriptive

---

## Definition of Done (PR-001)

PR-001 is considered **done** only when **all** conditions below are met:

* [ ] All required Symbol tests are implemented
* [ ] Tests fail before Symbol implementation is added
* [ ] Tests pass after implementation
* [ ] No tests exist outside Symbol scope
* [ ] No production code exists outside `domain/symbol.go`
* [ ] Symbol is immutable
* [ ] Symbol normalization is fully tested
* [ ] Equality semantics are fully tested
* [ ] Static analysis passes with no new warnings
* [ ] CI pipeline is green
* [ ] PR is reviewable in under 10 minutes

---

## Explicit Non-Goals

* No symbol parsing beyond normalization
* No exchange-specific knowledge
* No symbol registry or lookup
* No serialization concerns

---

## Reviewer Checklist

Reviewer must confirm:

* Tests clearly describe Symbol behavior
* Implementation matches tests exactly
* No scope creep occurred

---

## Guiding Principle

If PR-001 feels trivial, that means it is correct.
