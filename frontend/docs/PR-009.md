# PR-009 — Candle Chart Renderer (Detail Screen Only)

## Goal

Introduce a **candlestick chart renderer** used exclusively for the *detail / deep‑dive screen*, complementing the linear-first overview established in earlier PRs.

This PR completes the core dual‑representation model:

* **Line charts** for scanning
* **Candles** for analysis

---

## Scope

**Included**

* Candlestick chart renderer implementation
* Wiring via `SeriesChartRenderer`
* Visual semantics appropriate for analysis (but still minimal)

**Explicitly Excluded**

* Indicators (RSI, EMA, etc.)
* User toggles between line / candle
* Overview screen usage
* Interactivity beyond basic rendering

---

## Design Principles

* Candles are for **interpretation**, not scanning
* Renderer must be isolated from overview code paths
* Visual clarity over TradingView‑level feature parity
* Consistent domain inputs with line renderer

---

## Rendering Rules

The candle chart renderer must:

* Use full OHLC data from `CandleSeries`
* Render:

  * body (open → close)
  * wicks (high / low)
* Use color to indicate direction (up / down)
* Normalize prices to available vertical space

Visual constraints:

* No axes
* No labels
* No grid
* No volume bars
* No annotations

---

## Implementation Details

### Renderer

Implement a concrete renderer:

```dart
class CandleSeriesChartRenderer implements SeriesChartRenderer {
  @override
  Widget build(
    BuildContext context, {
    required CandleSeries series,
    required SeriesViewMode viewMode,
  }) {
    // viewMode must be SeriesViewMode.candles
  }
}
```

Rules:

* Renderer must assert or guard that `viewMode == SeriesViewMode.candles`
* Input is always `CandleSeries` (no alternate DTOs)

---

### Rendering Technique

* Use `CustomPainter`
* Precompute candle geometry (body + wick)
* Maintain consistent candle width based on available space
* Guard against empty or single‑candle series

---

## Tests

### Required

* Unit test: candle geometry calculation from OHLC
* Unit test: normalization logic (min/max price)
* Widget test: renderer builds without error for valid series

### Explicitly Not Required

* Golden tests
* Gesture / interaction tests
* Performance benchmarking

---

## Acceptance Criteria

PR-009 is complete when:

* Candle renderer exists and is wired via `SeriesChartRenderer`
* Renderer is used **only** in detail screen code paths
* Overview remains line‑only
* No indicator logic is introduced
* No backend or domain changes occur

---

## Follow-ups

Planned next PRs:

* **PR-010** — Overview screen layout & composition
* **PR-011** — Detail screen composition
* **PR-012** — Symbol scoring (domain)

---

## Non-Goals

* Indicator overlays
* Advanced candlestick styling
* User preferences
* Multi‑timeframe comparison

This PR establishes the *analysis lens* without diluting the scanning experience.
