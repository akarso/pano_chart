# PR-005 — Frontend Composition Root & Dependency Wiring

## Purpose

Introduce the **frontend composition root** that wires together:

* HTTP adapter
* Application use cases
* App bootstrap

This PR defines **how frontend pieces are connected**, without introducing UI features or business logic.

---

## References

* `AGENTS.md` — global collaboration rules
* `COMMON.md` — shared semantics
* `frontend/PR-001.md` — app skeleton
* `frontend/PR-002.md` — API client port & DTOs
* `frontend/PR-003.md` — GetCandleSeries use case
* `frontend/PR-004.md` — HTTP adapter

---

## Scope (Hard Lock)

### ✅ Included

* Dependency wiring for Candle feature
* Composition root setup
* Environment-based configuration
* Bootstrap-level tests

### ❌ Excluded

* UI widgets or screens
* Chart rendering
* State management frameworks
* Feature logic

If it paints pixels, it does not belong here.

---

## Folder Structure

```
/frontend/lib/
  core/
    di/
      composition_root.dart

/frontend/test/
  core/di/
```

---

## Composition Responsibilities

### Dependency Graph

```
GetCandleSeries Use Case
  → CandleApi (interface)
    → HttpCandleApi (adapter)
      → http.Client
```

The composition root is the **only place** where concrete implementations are chosen.

---

## Configuration

The composition root must accept:

* API base URL

Configuration sources:

* Constructor parameters
* Compile-time variables

No hard-coded URLs.

---

## Bootstrap Rules

* Composition must occur before widget tree creation
* No lazy singletons
* No global service locators

Explicit wiring only.

---

## Testing Requirements

### Required Test Cases

* `CompositionRoot_wiresGetCandleSeries`
* `CompositionRoot_usesHttpCandleApi`

Tests may use fake HTTP clients.

---

## Implementation Constraints

* No third-party DI frameworks
* No reflection
* No runtime type lookups

Keep wiring explicit and readable.

---

## Definition of Done (PR-005)

PR-005 is considered **done** only when **all** conditions below are met:

* [ ] Composition root exists
* [ ] Dependencies wired explicitly
* [ ] API base URL is configurable
* [ ] Tests verify wiring
* [ ] No UI code present
* [ ] Static analysis passes
* [ ] PR is reviewable in under 20 minutes

---

## Explicit Non-Goals

* No environment switching UI
* No runtime reconfiguration

---

## Reviewer Checklist

Reviewer must confirm:

* No business logic in wiring
* No hidden singletons
* Clear dependency graph

---

## Guiding Principle

Composition is where decisions end, not where logic lives.
